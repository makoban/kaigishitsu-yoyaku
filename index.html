<!DOCTYPE html>
<html>
<head>
    <title>ä¼šè­°å®¤äºˆç´„è¡¨ç¤º</title>
    <script src="https://apis.google.com/js/api.js"></script>
    <script src="https://accounts.google.com/gsi/client"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.4.1/papaparse.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=M+PLUS+Rounded+1c&family=Mochiy+Pop+One&family=Rampart+One&family=Roboto:ital,wght@0,100..900;1,100..900&family=Shippori+Antique+B1&family=Zen+Antique&family=Zen+Old+Mincho&display=swap" rel="stylesheet">
    <style>
        /* ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆãƒ†ãƒ¼ãƒ (ãƒãƒƒãƒ—/Pop) - æ˜ã‚‹ããƒ•ãƒ¬ãƒ³ãƒ‰ãƒªãƒ¼ãªè‰²åˆã„ */
        :root {
            --primary-color: #4285F4; /* Google Blue */
            --secondary-color: #28a745; /* Green */
            --accent-color: #6c757d; /* Gray */
            --text-color: #333;
            --light-text-color: #555;
            --background-color: #e8f5e9; /* Light Mint */
            --panel-bg-color: #ffffff;
            --border-color: #c8e6c9;
            --error-color: #dc3545;
            --delete-button-color: #dc3545;
            --highlight-color: #ffe082; /* Amber */
            --announcement-bg-color: #ffc107; /* Orange */
            --announcement-text-color: #333;
            --available-color: #a5d6a7; /* Light Green */
            --pre-announcement-bg-color: #add8e6; /* Light Blue for pre-announcement */
            --pre-announcement-text-color: #333;
            --border-radius: 12px;
            --box-shadow: 0 4px 10px rgba(0,0,0,0.08);
            --base-font-size: 16px; /* åŸºæœ¬ãƒ•ã‚©ãƒ³ãƒˆã‚µã‚¤ã‚º */
            --base-font-family: 'Zen Kaku Gothic New', 'Noto Sans JP', sans-serif; /* æ–°è¦: åŸºæœ¬ãƒ•ã‚©ãƒ³ãƒˆãƒ•ã‚¡ãƒŸãƒªãƒ¼ */
        }

        /* ã‚·ãƒƒã‚¯ãƒ†ãƒ¼ãƒ */
        body.theme-chic {
            --primary-color: #5d4037; /* Dark Brown */
            --secondary-color: #bcaaa4; /* Light Brown */
            --accent-color: #8d6e63; /* Medium Brown */
            --text-color: #3e2723; /* Very Dark Brown */
            --light-text-color: #5d4037;
            --background-color: #f5f5f5; /* Off-White */
            --panel-bg-color: #efebe9; /* Slightly darker Off-White */
            --border-color: #d7ccc8;
            --error-color: #c62828;
            --delete-button-color: #c62828;
            --highlight-color: #ffecb3; /* Creamy Yellow */
            --announcement-bg-color: #ffab40; /* Amber */
            --announcement-text-color: #333;
            --available-color: #a1887f; /* Muted Green-Brown */
            --pre-announcement-bg-color: #8d6e63; /* Medium Brown */
            --pre-announcement-text-color: white;
            --border-radius: 4px; /* ã‚·ãƒ£ãƒ¼ãƒ—ãªè§’ */
            --box-shadow: 0 2px 8px rgba(0,0,0,0.12);
        }

        /* ã‚¹ã‚¿ã‚¤ãƒªãƒƒã‚·ãƒ¥ãƒ†ãƒ¼ãƒ (è–„ã„ãƒ–ãƒ«ãƒ¼åŸºèª¿) */
        body.theme-stylish {
            --primary-color: #007BFF; /* Bright Blue */
            --secondary-color: #17A2B8; /* Teal Blue */
            --accent-color: #6C757D; /* Gray */
            --text-color: #343A40; /* Darker text color */
            --light-text-color: #6C757D; /* Lighter text color */
            --background-color: #E9F5FF; /* Very Light Blue */
            --panel-bg-color: #FFFFFF; /* White for panels */
            --border-color: #C5E1FF; /* Light Blue border */
            --error-color: #DC3545; /* Red for errors */
            --delete-button-color: #DC3545; /* Red for delete buttons */
            --highlight-color: #DBEDFF; /* Light Cyan for current event highlight */
            --announcement-bg-color: #007BFF; /* Primary blue for announcement */
            --announcement-text-color: white; /* White for announcement text */
            --available-color: #85CEFF; /* Light blue for "Available" */
            --pre-announcement-bg-color: #64B5F6; /* Slightly darker blue for pre-announcement */
            --pre-announcement-text-color: white; /* White for pre-announcement text */
            --border-radius: 8px; /* æ¨™æº–çš„ãªè§’ */
            --box-shadow: 0 6px 20px rgba(0,0,0,0.1);
        }


        body {
            font-family: var(--base-font-family); /* å¤‰æ›´: CSSå¤‰æ•°ã‚’ä½¿ç”¨ */
            margin: 0;
            padding: 20px;
            background-color: var(--background-color);
            color: var(--text-color);
            display: flex;
            flex-direction: column;
            align-items: center; /* ä¸­å¤®æƒãˆ */
            min-height: 100vh;
            box-sizing: border-box;
            font-size: var(--base-font-size); /* CSSå¤‰æ•°ã‚’ä½¿ç”¨ */
            transition: background-color 0.3s ease, color 0.3s ease, font-size 0.3s ease, font-family 0.3s ease; /* transitionã«è¿½åŠ  */
        }

        h1 {
            font-size: 2.5em; /* ç›¸å¯¾å˜ä½ */
        }
        h2 {
            font-size: 2em; /* ç›¸å¯¾å˜ä½ */
        }
        h3 {
            font-size: 1.5em; /* ç›¸å¯¾å˜ä½ */
        }
        h4 {
            font-size: 1.2em; /* ç›¸å¯¾å˜ä½ */
        }
        
        /* h1, h2, h3, h4 ã®ã‚¹ã‚¿ã‚¤ãƒ«ã¯æ®‹ã—ã¤ã¤ã€emå˜ä½ã§ç›¸å¯¾çš„ã«å¤‰æ›´ */
        h1, h2, h3, h4 {
            color: var(--primary-color);
            margin-top: 0;
            margin-bottom: 20px; /* ä½™ç™½ã‚’å¤§ãã‚ã« */
            font-weight: 500;
            transition: color 0.3s ease; /* ãƒ†ãƒ¼ãƒåˆ‡ã‚Šæ›¿ãˆæ™‚ã®ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ */
        }
        /* Header */
        header {
            width: 100%; /* è¦ªè¦ç´ ã®å¹…ã«åˆã‚ã›ã‚‹ */
            max-width: 900px; /* æœ€å¤§å¹…ã‚’è¨­å®š */
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px; /* ä½™ç™½ã‚’å¤§ãã‚ã« */
            position: relative; /* ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼åé…ç½®ã®ãŸã‚ */
            padding: 0 20px; /* å·¦å³ã®ä½™ç™½ */
            box-sizing: border-box; /* paddingã‚’å«ã‚ã¦å¹…ã‚’è¨ˆç®— */
        }
        #display_calendar_summary_top { /* ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼åï¼ˆä¸Šéƒ¨ï¼‰ã®ã‚¹ã‚¿ã‚¤ãƒ« */
            position: absolute;
            top: 25px; /* H1ã¨è¨­å®šãƒœã‚¿ãƒ³ã®é–“ã«é…ç½® */
            left: 20px; /* H1ã®å·¦ç«¯ã«åˆã‚ã›ã‚‹ */
            font-size: 1.6em; /* ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ã‚µãƒãƒªãƒ¼ã‚’èª¿æ•´ */
            font-weight: 500;
            color: var(--light-text-color);
            transform: translateY(50px); /* H1ã®ä¸‹ã«ã‚¹ãƒšãƒ¼ã‚¹ã‚’é–‹ã‘ã‚‹ */
        }


        /* Top Bar for Date/Time and Announcement */
        #top_bar {
            width: 100%;
            max-width: 900px; /* æœ€å¤§å¹…ã‚’è¨­å®š */
            background-color: var(--panel-bg-color);
            border-radius: var(--border-radius); /* ãƒ†ãƒ¼ãƒã«åˆã‚ã›ã‚‹ */
            box-shadow: var(--box-shadow); /* ãƒ†ãƒ¼ãƒã«åˆã‚ã›ã‚‹ */
            margin-bottom: 30px; /* ä½™ç™½ã‚’å¤§ãã */
            padding: 25px 30px; /* ãƒ‘ãƒ‡ã‚£ãƒ³ã‚°ã‚’å¤§ãã */
            display: flex;
            flex-direction: column; /* ç¸¦ä¸¦ã³ã« */
            align-items: center; /* ä¸­å¤®å¯„ã› */
            text-align: center;
            font-size: 1.2em; /* èª¿æ•´ */
            color: var(--text-color);
            transition: background-color 0.3s ease, box-shadow 0.3s ease;
            box-sizing: border-box; /* paddingã‚’å«ã‚ã¦å¹…ã‚’è¨ˆç®— */
        }
        #current_datetime {
            font-weight: bold;
            color: var(--secondary-color); /* è‰²ã‚’èª¿æ•´ */
            margin-bottom: 10px; /* æ—¥ä»˜ã¨æ¡ˆå†…ã®é–“ã«ä½™ç™½ */
            font-size: 1.1em; /* æ—¥ä»˜æ™‚åˆ»ã‚’èª¿æ•´ */
            transition: color 0.3s ease;
        }
        /* Pre-announcement (äºˆç´„å‰æ¡ˆå†…) */
        #pre_announcement_text {
            font-weight: bold;
            color: var(--pre-announcement-text-color);
            background-color: var(--pre-announcement-bg-color);
            padding: 15px 30px;
            border-radius: var(--border-radius);
            font-size: 1.8em; /* ç¾åœ¨ã®æ¡ˆå†…æ–‡ã‚’èª¿æ•´ */
            display: none;
            width: 100%;
            box-sizing: border-box;
            margin-bottom: 15px; /* ä¸‹ã«ã‚¹ãƒšãƒ¼ã‚¹ */
            transition: background-color 0.3s ease, color 0.3s ease;
        }
        #announcement_text { /* Current event announcement */
            font-weight: bold;
            color: var(--announcement-text-color);
            background-color: var(--announcement-bg-color);
            padding: 15px 30px; /* ãƒ‘ãƒ‡ã‚£ãƒ³ã‚°ã‚’å¤§ãã */
            border-radius: var(--border-radius); /* ãƒ†ãƒ¼ãƒã«åˆã‚ã›ã‚‹ */
            font-size: 1.8em; /* æ¡ˆå†…æ–‡ã‚’èª¿æ•´ */
            display: none; /* Initially hidden */
            width: 100%; /* å¹…ã„ã£ã±ã„ */
            box-sizing: border-box;
            transition: background-color 0.3s ease, color 0.3s ease;
        }
        #announcement_text.available { /* ç©ºå®¤æ™‚ã®ã‚¹ã‚¿ã‚¤ãƒ« */
            background-color: var(--available-color);
            color: var(--text-color);
        }

        /* Settings Button */
        #settings_button {
            padding: 10px 22px; /* ãƒœã‚¿ãƒ³ã‚’èª¿æ•´ */
            font-size: 0.9em; /* ãƒ•ã‚©ãƒ³ãƒˆã‚µã‚¤ã‚ºã‚‚èª¿æ•´ */
            background-color: var(--accent-color);
            color: white;
            border: none;
            border-radius: var(--border-radius); /* ãƒ†ãƒ¼ãƒã«åˆã‚ã›ã‚‹ */
            cursor: pointer;
            transition: background-color 0.2s ease-in-out, border-radius 0.3s ease, box-shadow 0.2s ease; /* box-shadowã‚‚ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ */
            position: fixed; 
            top: 20px;
            right: 20px;
            z-index: 101; 
            box-shadow: 0 4px 8px rgba(0,0,0,0.2); /* å½±ã‚’è¿½åŠ  */
            /* åˆæœŸã¯éè¡¨ç¤º */
            display: none; 
        }
        #settings_button:hover {
            background-color: #5a6268; /* Hover color for gray accent */
            box-shadow: 0 6px 12px rgba(0,0,0,0.25); /* ãƒ›ãƒãƒ¼æ™‚ã®å½±ã‚’æ¿ƒã */
        }

        /* Version Info */
        #version_info {
            position: fixed;
            top: 70px; /* è¨­å®šãƒœã‚¿ãƒ³ã®ä¸‹ */
            right: 20px;
            z-index: 100;
            font-size: 0.8em;
            color: var(--light-text-color);
            background-color: var(--panel-bg-color);
            padding: 5px 10px;
            border-radius: var(--border-radius);
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            border: 1px solid var(--border-color);
            transition: background-color 0.3s ease, color 0.3s ease;
        }

        /* Settings Panel */
        #settings_panel {
            position: fixed; 
            top: 0;
            right: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.5); 
            display: flex;
            justify-content: flex-end; 
            z-index: 100;
            opacity: 0;
            pointer-events: none; 
            transition: opacity 0.3s ease-in-out;
        }
        #settings_panel.open {
            opacity: 1;
            pointer-events: auto;
        }
        #settings_content {
            background-color: var(--panel-bg-color);
            width: 500px; /* ãƒ‘ãƒãƒ«ã®å¹…ã‚’å°‘ã—åºƒã’ã‚‹ */
            max-width: 90%;
            height: 100%;
            padding: 30px;
            box-sizing: border-box;
            box-shadow: -5px 0 15px rgba(0,0,0,0.2);
            transform: translateX(100%); 
            transition: transform 0.3s ease-in-out, background-color 0.3s ease;
            display: flex;
            flex-direction: column;
            position: relative;
            /* ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ã‚’å¯èƒ½ã«ã™ã‚‹ */
            overflow-y: auto; 
        }
        #settings_panel.open #settings_content {
            transform: translateX(0); 
        }
        #close_settings_panel {
            position: absolute;
            top: 15px;
            right: 15px;
            background: none;
            border: none;
            font-size: 2.2em; /* ãƒœã‚¿ãƒ³ã‚’èª¿æ•´ */
            cursor: pointer;
            color: var(--accent-color);
            line-height: 1;
            padding: 5px;
        }
        #close_settings_panel:hover {
            color: var(--text-color);
        }

        /* Auth Section in Settings Panel */
        /* ã‚¢ã‚«ã‚¦ãƒ³ãƒˆèªè¨¼ã‚»ã‚¯ã‚·ãƒ§ãƒ³ */
        .setting-group.auth-section-group { /* Authã‚»ã‚¯ã‚·ãƒ§ãƒ³ã®ã‚¹ã‚¿ã‚¤ãƒ« */
            margin-bottom: 25px; /* ä¸‹éƒ¨ä½™ç™½ */
            padding-bottom: 20px; /* ä¸‹éƒ¨ãƒ‘ãƒ‡ã‚£ãƒ³ã‚° */
            border-bottom: 1px dashed var(--border-color); /* ä¸‹ç·š */
        }
        #auth_status {
            margin-bottom: 25px; 
            padding: 20px; 
            background-color: #E9F5FF; /* èªè¨¼ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã¯é’ç³»ã‚’ç¶­æŒ */
            border: 1px solid #C5E1FF;
            border-radius: var(--border-radius); 
            text-align: center;
            font-size: 1em; /* èª¿æ•´ */
            line-height: 1.5;
        }
        #authorize_button, #switch_account_button {
            padding: 12px 25px; /* ãƒœã‚¿ãƒ³ã‚’èª¿æ•´ */
            font-size: 1em; /* ãƒ•ã‚©ãƒ³ãƒˆã‚µã‚¤ã‚ºã‚’èª¿æ•´ */
            background-color: var(--primary-color);
            color: white;
            border: none;
            border-radius: var(--border-radius); 
            cursor: pointer;
            transition: background-color 0.2s ease-in-out, border-radius 0.3s ease, box-shadow 0.2s ease, transform 0.1s ease;
            width: 100%;
            margin-bottom: 15px; 
            box-shadow: 0 4px 8px rgba(0,0,0,0.15); /* å½±ã‚’è¿½åŠ  */
        }
        #authorize_button:hover, #switch_account_button:hover {
            background-color: #0056B3; /* Darker blue hover */
            box-shadow: 0 6px 12px rgba(0,0,0,0.2); /* ãƒ›ãƒãƒ¼æ™‚ã®å½±ã‚’æ¿ƒã */
        }
        #authorize_button:active, #switch_account_button:active {
            transform: translateY(2px); /* ã‚¯ãƒªãƒƒã‚¯æ™‚ã®ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ */
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        #authorize_button:disabled, #switch_account_button:disabled {
            background-color: #a0a0a0;
            cursor: not-allowed;
            box-shadow: none;
        }
        #calendar_selection_panel {
            margin-top: 25px;
            padding-top: 25px;
            border-top: 1px dashed var(--border-color);
            flex-grow: 1; 
            overflow-y: auto; 
            min-height: 200px; /* æœ€å°é«˜ã•ã‚’ç¢ºä¿ */
            max-height: 50vh; /* æœ€å¤§é«˜ã•ã‚’ãƒ“ãƒ¥ãƒ¼ãƒãƒ¼ãƒˆã®50%ã«åˆ¶é™ */
        }
        #calendar_selection_panel h4 { /* ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ãƒªã‚¹ãƒˆã®ã‚¿ã‚¤ãƒˆãƒ« */
            margin-bottom: 15px;
            font-size: 1.05em; /* èª¿æ•´ */
            color: var(--text-color);
        }
        #writable_calendar_list {
            list-style: none;
            padding: 0;
            margin-top: 20px; 
        }
        #writable_calendar_list li {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 0; /* ãƒ‘ãƒ‡ã‚£ãƒ³ã‚°ã‚’èª¿æ•´ */
            border-bottom: 1px solid #f7f7f7;
            font-size: 1.05em; /* ãƒ•ã‚©ãƒ³ãƒˆã‚µã‚¤ã‚ºã‚’èª¿æ•´ */
            flex-wrap: wrap; /* é•·ã„å ´åˆã¯æŠ˜ã‚Šè¿”ã— */
        }
        #writable_calendar_list li:last-child {
            border-bottom: none;
        }
        
        /* è¿½åŠ ï¼šã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼æƒ…å ±è¡¨ç¤ºã‚¨ãƒªã‚¢ */
        .calendar-info {
            flex: 1;
            margin-right: 10px;
        }
        .calendar-name {
            font-weight: 500;
            margin-bottom: 3px;
        }
        .calendar-details {
            font-size: 0.85em;
            color: var(--light-text-color);
        }
        .calendar-expiry {
            font-size: 0.8em;
            padding: 2px 6px;
            border-radius: 3px;
            margin-left: 8px;
        }
        .calendar-expiry.valid {
            background-color: #d4edda;
            color: #155724;
        }
        .calendar-expiry.warning {
            background-color: #fff3cd;
            color: #856404;
        }
        .calendar-expiry.expired {
            background-color: #f8d7da;
            color: #721c24;
        }
        .select-button {
            padding: 10px 20px; /* ãƒœã‚¿ãƒ³ã‚’èª¿æ•´ */
            font-size: 0.95em; /* ãƒ•ã‚©ãƒ³ãƒˆã‚µã‚¤ã‚ºèª¿æ•´ */
            background-color: var(--secondary-color);
            color: white;
            border: none;
            border-radius: var(--border-radius); /* ãƒ†ãƒ¼ãƒã«åˆã‚ã›ã‚‹ */
            cursor: pointer;
            transition: background-color 0.2s ease-in-out, border-radius 0.3s ease, box-shadow 0.2s ease, transform 0.1s ease;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1); /* å½±ã‚’è¿½åŠ  */
        }
        .select-button:hover {
            background-color: #138496; /* Darker teal hover */
            box-shadow: 0 4px 8px rgba(0,0,0,0.15); /* ãƒ›ãƒãƒ¼æ™‚ã®å½±ã‚’æ¿ƒã */
        }
        .select-button:active {
            transform: translateY(2px); /* ã‚¯ãƒªãƒƒã‚¯æ™‚ã®ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ */
            box-shadow: 0 1px 2px rgba(0,0,0,0.08);
        }

        /* Calendar Security Status */
        .calendar-security-status {
            background-color: #f8f9fa;
            border: 1px solid var(--border-color);
            border-radius: var(--border-radius);
            padding: 10px;
            margin-bottom: 15px;
            font-size: 0.9em;
        }
        .calendar-security-status.success {
            background-color: #d4edda;
            border-color: #c3e6cb;
            color: #155724;
        }
        .calendar-security-status.error {
            background-color: #f8d7da;
            border-color: #f5c6cb;
            color: #721c24;
        }
        .calendar-security-status.expired {
            background-color: #f8d7da;
            border-color: #f5c6cb;
            color: #721c24;
        }

        /* è¿½åŠ ï¼šæœŸé™åˆ‡ã‚Œã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼è¡¨ç¤ºç”¨ã‚¹ã‚¿ã‚¤ãƒ« */
        .expired-calendar-notice {
            background-color: #f8d7da;
            border: 1px solid #f5c6cb;
            border-radius: var(--border-radius);
            padding: 15px;
            margin: 15px 0;
            color: #721c24;
            font-size: 0.9em;
            line-height: 1.5;
        }
        .expired-calendar-name {
            color: #dc3545;
            font-weight: bold;
            font-size: 1.1em;
        }
        .switch-account-notice {
            margin-top: 10px;
            font-style: italic;
            color: #856404;
            background-color: #fff3cd;
            padding: 8px;
            border-radius: 4px;
            border-left: 4px solid #ffc107;
        }

        /* Settings Options */
        .setting-group {
            margin-bottom: 25px;
            padding-bottom: 20px;
            border-bottom: 1px dashed var(--border-color);
        }
        .setting-group:last-of-type {
            border-bottom: none;
        }
        .setting-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: var(--light-text-color);
            font-size: 0.95em; /* èª¿æ•´ */
        }
        .setting-group input[type="text"],
        .setting-group input[type="number"],
        .setting-group select {
            width: calc(100% - 20px);
            padding: 8px; /* èª¿æ•´ */
            margin-bottom: 10px;
            border: 1px solid var(--border-color);
            border-radius: var(--border-radius);
            font-size: 0.95em; /* èª¿æ•´ */
            box-sizing: border-box;
            transition: border-color 0.2s ease, border-radius 0.3s ease;
        }
        .setting-group input[type="text"]:focus,
        .setting-group input[type="number"]:focus,
        .setting-group select:focus {
            border-color: var(--primary-color);
            outline: none;
        }

        /* Main Content Area */
        #container {
            flex-grow: 1;
            display: flex;
            gap: 30px; 
            position: relative; 
            width: 100%;
            max-width: 900px; /* æœ€å¤§å¹…ã‚’è¨­å®š */
            padding: 0 20px; /* å·¦å³ã®ä½™ç™½ */
            box-sizing: border-box; /* paddingã‚’å«ã‚ã¦å¹…ã‚’è¨ˆç®— */
        }
        #event_list_container {
            flex: 1;
            padding: 30px;
            background-color: var(--panel-bg-color);
            border-radius: var(--border-radius); 
            box-shadow: var(--box-shadow); 
            transition: background-color 0.3s ease, box-shadow 0.3s ease, border-radius 0.3s ease;
        }
        #selected_calendar_info { /* ã“ã®è¦ç´ ã¯æ®‹ã™ãŒã€ä¸­èº«ã¯ç©ºã«ãªã‚‹ */
            display: none; /* ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼åã¯ä¸Šã«ç§»å‹•ã—ãŸã®ã§éè¡¨ç¤º */
        }
        #event_list {
            list-style: none;
            padding: 0;
        }
        #event_list li {
            background-color: #fdfdfd;
            border: 1px solid var(--border-color); /* æ ç·šã®è‰²ã‚’ãƒ†ãƒ¼ãƒã«åˆã‚ã›ã‚‹ */
            border-radius: var(--border-radius); /* ãƒ†ãƒ¼ãƒã«åˆã‚ã›ã‚‹ */
            margin-bottom: 18px; /* èª¿æ•´ */
            padding: 18px 22px; /* èª¿æ•´ */
            display: flex; 
            justify-content: space-between; 
            align-items: center; 
            box-shadow: 0 2px 6px rgba(0,0,0,0.08); /* ã‚«ãƒ¼ãƒ‰UIã®å½± */
            transition: transform 0.2s ease-out, box-shadow 0.2s ease-out, background-color 0.2s ease-in-out, border-radius 0.3s ease;
        }
        #event_list li:hover {
            transform: translateY(-5px); /* ãƒ›ãƒãƒ¼ã‚¨ãƒ•ã‚§ã‚¯ãƒˆ */
            box-shadow: 0 8px 25px rgba(0,0,0,0.15); /* ãƒ›ãƒãƒ¼ã‚¨ãƒ•ã‚§ã‚¯ãƒˆæ™‚ã®å½±ã‚’æ¿ƒã */
        }
        /* Highlight for current event */
        #event_list li.current-event {
            background-color: var(--highlight-color);
            border-color: var(--primary-color); /* ãƒã‚¤ãƒ©ã‚¤ãƒˆæ™‚ã®æ ç·šã®è‰²ã‚’ primary color ã« */
            box-shadow: 0 6px 20px rgba(0, 123, 255, 0.3); /* Primary color ã«åˆã‚ã›ãŸå½± */
        }

        .event-details {
            flex-grow: 1; 
        }
        .event-time {
            font-weight: 700; 
            color: var(--primary-color);
            font-size: 1.2em; /* èª¿æ•´ */
            margin-bottom: 6px; /* èª¿æ•´ */
            display: block;
            transition: color 0.3s ease;
        }
        .event-summary {
            color: var(--text-color);
            font-size: 1.1em; /* èª¿æ•´ */
            line-height: 1.4;
        }
        .no-events {
            font-style: italic;
            color: var(--light-text-color);
            text-align: center;
            padding: 30px; /* èª¿æ•´ */
            font-size: 1.1em; /* èª¿æ•´ */
        }

        /* Action Buttons */
        .action-button-group {
            margin-top: 35px; /* èª¿æ•´ */
            padding-top: 20px; /* èª¿æ•´ */
            border-top: 1px dashed var(--border-color);
            display: flex;
            gap: 15px; /* èª¿æ•´ */
            flex-wrap: wrap;
            justify-content: center; /* ãƒœã‚¿ãƒ³ã‚’ä¸­å¤®æƒãˆã« */
        }
        .action-button {
            padding: 12px 22px; /* ãƒœã‚¿ãƒ³ã‚’èª¿æ•´ */
            font-size: 1em; /* ãƒ•ã‚©ãƒ³ãƒˆã‚µã‚¤ã‚ºã‚’èª¿æ•´ */
            background-color: var(--primary-color);
            color: white;
            border: none;
            border-radius: var(--border-radius); /* ãƒ†ãƒ¼ãƒã«åˆã‚ã›ã‚‹ */
            cursor: pointer;
            transition: background-color 0.2s ease-in-out, border-radius 0.3s ease, box-shadow 0.2s ease, transform 0.1s ease;
            box-shadow: 0 4px 8px rgba(0,0,0,0.15); /* å½±ã‚’è¿½åŠ  */
            flex-grow: 1; 
            min-width: 140px; /* èª¿æ•´ */
            max-width: 230px; /* èª¿æ•´ */
        }
        .action-button:hover {
            background-color: #0056B3; /* Darker blue hover */
            box-shadow: 0 6px 12px rgba(0,0,0,0.2); /* ãƒ›ãƒãƒ¼æ™‚ã®å½±ã‚’æ¿ƒã */
        }
        .action-button:active {
            transform: translateY(2px); /* ã‚¯ãƒªãƒƒã‚¯æ™‚ã®ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ */
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        /* Disabled state for action buttons */
        .action-button:disabled,
        .event-delete-button:disabled {
            background-color: #cccccc; /* ã‚°ãƒ¬ãƒ¼ã‚¢ã‚¦ãƒˆ */
            cursor: not-allowed;
            box-shadow: none;
            opacity: 0.7; /* å°‘ã—é€æ˜ã« */
            transform: none; /* ç„¡åŠ¹æ™‚ã¯ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ã—ãªã„ */
        }

        .error-message {
            color: var(--error-color);
            font-weight: 700;
            margin-top: 20px; /* èª¿æ•´ */
            text-align: center;
            font-size: 1.1em; /* èª¿æ•´ */
            background-color: #FFE5E5; /* ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®èƒŒæ™¯ã¯èµ¤ç³»ã‚’ç¶­æŒ */
            padding: 18px; /* èª¿æ•´ */
            border-radius: var(--border-radius); /* ãƒ†ãƒ¼ãƒã«åˆã‚ã›ã‚‹ */
            border: 1px solid var(--error-color);
            width: 100%;
            max-width: 900px; /* æœ€å¤§å¹…ã‚’è¨­å®š */
            box-sizing: border-box;
        }
        /* New delete button for each event item */
        .event-delete-button {
            padding: 8px 16px; /* èª¿æ•´ */
            font-size: 0.9em; /* èª¿æ•´ */
            background-color: var(--delete-button-color); 
            color: white;
            border: none;
            border-radius: var(--border-radius); /* ãƒ†ãƒ¼ãƒã«åˆã‚ã›ã‚‹ */
            cursor: pointer;
            transition: background-color 0.2s ease-in-out, border-radius 0.3s ease, box-shadow 0.2s ease, transform 0.1s ease;
            margin-left: 15px; /* èª¿æ•´ */
            flex-shrink: 0; 
            box-shadow: 0 2px 5px rgba(0,0,0,0.1); /* å½±ã‚’è¿½åŠ  */
        }
        .event-delete-button:hover {
            background-color: #A00000; /* Darker red hover */
            box-shadow: 0 4px 8px rgba(0,0,0,0.15); /* ãƒ›ãƒãƒ¼æ™‚ã®å½±ã‚’æ¿ƒã */
        }
        .event-delete-button:active {
            transform: translateY(2px); /* ã‚¯ãƒªãƒƒã‚¯æ™‚ã®ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ */
            box-shadow: 0 1px 2px rgba(0,0,0,0.08);
        }

        /* ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–ãƒ‡ã‚¶ã‚¤ãƒ³ */
        @media (max-width: 768px) {
            body {
                padding: 15px;
                font-size: var(--base-font-size); /* ç›¸å¯¾å˜ä½ãªã®ã§ãã®ã¾ã¾ */
            }
            header, #top_bar, #container, .error-message {
                padding: 0 10px;
                max-width: 100%; /* å°ã•ã„ç”»é¢ã§ã¯å…¨å¹…ã‚’ä½¿ç”¨ */
            }
            header h1 {
                font-size: 2em; /* ç›¸å¯¾å˜ä½ */
            }
            #display_calendar_summary_top {
                font-size: 1.3em; /* ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–ã§ã‚‚å°‘ã—å¤§ãã */
                transform: translateY(35px); /* èª¿æ•´ */
            }
            #top_bar {
                padding: 15px 20px;
            }
            #current_datetime {
                font-size: 1.1em; /* ç›¸å¯¾å˜ä½ */
            }
            #pre_announcement_text, #announcement_text {
                font-size: 1.4em; /* ç›¸å¯¾å˜ä½ */
                padding: 10px 15px;
            }
            #settings_button {
                padding: 8px 18px; /* èª¿æ•´ */
                font-size: 0.85em; /* ç›¸å¯¾å˜ä½ */
                top: 15px;
                right: 15px;
            }
            #version_info {
                top: 55px; /* è¨­å®šãƒœã‚¿ãƒ³ã®ä½ç½®ã«åˆã‚ã›ã¦èª¿æ•´ */
                right: 15px;
                font-size: 0.75em;
            }
            #settings_content {
                width: 100%;
                max-width: 100%;
                padding: 20px;
            }
            .setting-group {
                margin-bottom: 18px; /* èª¿æ•´ */
                padding-bottom: 12px; /* èª¿æ•´ */
            }
            #authorize_button, #switch_account_button, .select-button, .action-button {
                padding: 10px 18px; /* èª¿æ•´ */
                font-size: 0.95em; /* ç›¸å¯¾å˜ä½ */
            }
            #event_list_container {
                padding: 18px; /* èª¿æ•´ */
            }
            #event_list li {
                flex-direction: column; /* ç¸¦ä¸¦ã³ã« */
                align-items: flex-start; /* å·¦å¯„ã› */
                padding: 12px; /* èª¿æ•´ */
            }
            .event-time, .event-summary {
                font-size: 1em; /* ç›¸å¯¾å˜ä½ */
            }
            .event-delete-button {
                margin-left: 0; /* å·¦ãƒãƒ¼ã‚¸ãƒ³ã‚’ãªãã™ */
                margin-top: 8px; /* ä¸Šã«ãƒãƒ¼ã‚¸ãƒ³ã‚’è¿½åŠ  */
                width: 100%; /* å¹…ã„ã£ã±ã„ã« */
                padding: 7px 14px; /* èª¿æ•´ */
            }
            .action-button-group {
                flex-direction: column;
                gap: 12px; /* èª¿æ•´ */
            }
            .action-button {
                min-width: unset;
                max-width: unset;
                width: 100%;
            }
            /* ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼æƒ…å ±ã®ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–å¯¾å¿œ */
            #writable_calendar_list li {
                flex-direction: column;
                align-items: flex-start;
            }
            .calendar-info {
                margin-right: 0;
                margin-bottom: 10px;
                width: 100%;
            }
        }

        @media (max-width: 480px) {
            header h1 {
                font-size: 1.6em; /* ç›¸å¯¾å˜ä½ */
            }
            #display_calendar_summary_top {
                font-size: 1.1em; /* ç›¸å¯¾å˜ä½ */
                transform: translateY(25px); /* èª¿æ•´ */
            }
            #current_datetime {
                font-size: 0.9em; /* ç›¸å¯¾å˜ä½ */
            }
            #pre_announcement_text, #announcement_text {
                font-size: 1.1em; /* ç›¸å¯¾å˜ä½ */
                padding: 7px 10px; /* èª¿æ•´ */
            }
            #version_info {
                top: 50px;
                right: 10px;
                font-size: 0.7em;
                padding: 3px 6px;
            }
            .setting-group label, .setting-group input, .setting-group select {
                font-size: 0.85em; /* ç›¸å¯¾å˜ä½ */
            }
            #authorize_button, #switch_account_button, .select-button, .action-button, .event-delete-button {
                font-size: 0.85em; /* ç›¸å¯¾å˜ä½ */
                padding: 8px 12px; /* èª¿æ•´ */
            }
        }

    </style>
</head>
<body class="theme-stylish">
    <header>
        <h1 id="main_app_title">ä¼šè­°å®¤äºˆç´„è¡¨ç¤ºVer1.4</h1>
        <button id="settings_button">è¨­å®š</button> 
        <div id="version_info"></div>
        <span id="display_calendar_summary_top"></span>
    </header>

    <div id="top_bar">
        <span id="current_datetime"></span>
        <span id="pre_announcement_text"></span> 
        <span id="announcement_text"></span>
    </div>

    <div id="settings_panel">
        <div id="settings_content">
            <button id="close_settings_panel">&times;</button>
            <h2>è¨­å®š</h2>
            <hr>
            
            <div class="setting-group">
                <h3>ğŸ” ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£</h3>
                <div id="calendar_security_status" class="calendar-security-status">
                    ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼è¨±å¯çŠ¶æ…‹ã‚’ç¢ºèªä¸­...
                </div>
            </div>
            
            <div class="setting-group auth-section-group">
                <h3>ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã¨ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ã®åˆ‡ã‚Šæ›¿ãˆ</h3>
                <p id="auth_status" style="color: blue;">æ“ä½œã‚’è¡Œã†ã«ã¯Googleã‚¢ã‚«ã‚¦ãƒ³ãƒˆã§èªè¨¼ã—ã¦ãã ã•ã„ã€‚</p>
                <button id="authorize_button">Googleã‚¢ã‚«ã‚¦ãƒ³ãƒˆã§èªè¨¼</button>
                <button id="switch_account_button" style="display:none;">åˆ¥ã®ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã§èªè¨¼</button>
                <p style="font-size: 0.9em; color: var(--light-text-color); margin-top: 10px;">
                    â€»ç·Šæ€¥ä¼šè­°ã€å‰Šé™¤ãªã©ã®ç®¡ç†è€…æ“ä½œã‚’åˆ©ç”¨ã™ã‚‹éš›ã«èªè¨¼ãŒå¿…è¦ã§ã™ã€‚<br>
                    â€»èªè¨¼å¾Œã€è¡¨ç¤ºãƒ»æ“ä½œã™ã‚‹ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ã‚’é¸æŠã—ã¦ãã ã•ã„ã€‚
                </p>
                <div id="calendar_selection_panel" style="display: none;">
                    <div style="height: 3em; margin-bottom: 1em;"></div> <h4>è¡¨ç¤ºãƒ»æ“ä½œã™ã‚‹ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ã‚’é¸æŠ</h4>
                    <ul id="writable_calendar_list">
                        <li>èªè¨¼å¾Œã€ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ã‚’èª­ã¿è¾¼ã¿ä¸­...</li>
                    </ul>
                </div>
            </div>
            <div class="setting-group">
                <h3>ãƒ†ãƒ¼ãƒè¨­å®š</h3>
                <label for="theme_select">ãƒ†ãƒ¼ãƒã‚’é¸æŠ:</label>
                <select id="theme_select">
                    <option value="pop">ãƒãƒƒãƒ—</option>
                    <option value="chic">ã‚·ãƒƒã‚¯</option>
                    <option value="stylish">ã‚¹ã‚¿ã‚¤ãƒªãƒƒã‚·ãƒ¥</option>
                </select>
            </div>

            <div class="setting-group">
                <h3>æ›´æ–°æ™‚é–“è¨­å®š</h3>
                <label for="refresh_interval_select">æ›´æ–°é–“éš” (ç§’):</label>
                <select id="refresh_interval_select">
                    <option value="30">30ç§’</option>
                    <option value="60">60ç§’</option>
                    <option value="120">120ç§’</option>
                </select>
            </div>

            <div class="setting-group">
                <h3>è¡¨ç¤ºæœŸé–“è¨­å®š ğŸ—“ï¸</h3>
                <label for="display_past_hours_input">ç¾åœ¨æ™‚åˆ»ã‹ã‚‰ä½•æ™‚é–“å‰ã¾ã§è¡¨ç¤ºã™ã‚‹ã‹:</label>
                <input type="number" id="display_past_hours_input" min="0" max="24" value="2">
                <label for="display_future_hours_input">ç¾åœ¨æ™‚åˆ»ã‹ã‚‰ä½•æ™‚é–“å¾Œã¾ã§è¡¨ç¤ºã™ã‚‹ã‹:</label>
                <input type="number" id="display_future_hours_input" min="0" max="72" value="12">
            </div>

            <div class="setting-group">
                <h3>ãƒ•ã‚©ãƒ³ãƒˆã‚µã‚¤ã‚ºè¨­å®š ğŸ…°ï¸</h3>
                <label for="base_font_size_input">åŸºæœ¬ãƒ•ã‚©ãƒ³ãƒˆã‚µã‚¤ã‚º (px):</label>
                <input type="number" id="base_font_size_input" min="10" max="30" value="16">
            </div>

            <div class="setting-group">
                <h3>ãƒ•ã‚©ãƒ³ãƒˆã®ç¨®é¡è¨­å®š ğŸ”¡</h3>
                <label for="font_family_select">ãƒ•ã‚©ãƒ³ãƒˆã®ç¨®é¡:</label>
                <select id="font_family_select">
                    <option value="'Zen Kaku Gothic New', 'Noto Sans JP', sans-serif">Zen Kaku Gothic New (æ¨™æº–)</option>
                    <option value="'Noto Sans JP', sans-serif">Noto Sans JP</option>
                    <option value="'M PLUS Rounded 1c', sans-serif">M PLUS Rounded 1c</option>
                    <option value="'Mochiy Pop One', sans-serif">Mochiy Pop One</option>
                    <option value="'Rampart One', cursive">Rampart One</option> <option value="'Roboto', sans-serif">Roboto</option>
                    <option value="'Shippori Antique B1', sans-serif">Shippori Antique B1</option>
                    <option value="'Zen Antique', serif">Zen Antique</option> <option value="'Zen Old Mincho', serif">Zen Old Mincho</option> 
                    </select>
            </div>

            <div class="setting-group">
                <h3>è¡¨ç¤ºã‚¿ã‚¤ãƒˆãƒ«è¨­å®š</h3>
                <label for="main_title_input">ãƒ¡ã‚¤ãƒ³ã‚¿ã‚¤ãƒˆãƒ«:</label>
                <input type="text" id="main_title_input" value="ä¼šè­°å®¤äºˆç´„è¡¨ç¤ºVer1.2">

                <label for="event_list_title_input">ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒˆã‚¿ã‚¤ãƒˆãƒ«:</label>
                <input type="text" id="event_list_title_input" value="ç¾åœ¨ã®ä¼šè­°å®¤ã®äºˆå®š">
            </div>

            <div class="setting-group">
                <h3>æ¡ˆå†…æ¿ã®è¡¨ç¤ºè¨­å®š</h3>
                <label for="available_text_input">ç©ºå®¤æ™‚ã®è¡¨è¨˜:</label>
                <input type="text" id="available_text_input" value="ç©ºå®¤ã§ã™">

                <label for="in_progress_prefix_input">å½“è©²æ™‚é–“æ™‚ã®æ¥é ­èª:</label>
                <input type="text" id="in_progress_prefix_input" value="ãŸã ã„ã¾">

                <label for="in_progress_suffix_input">å½“è©²æ™‚é–“æ™‚ã®æ¥å°¾èª:</label>
                <input type="text" id="in_progress_suffix_input" value="ä¸­ã§ã™">
            </div>

            <div class="setting-group">
                <h3>äºˆç´„å‰æ¡ˆå†…è¨­å®š</h3>
                <label for="pre_announcement_minutes_select">äºˆç´„å‰æ¡ˆå†… (ä½•åˆ†å‰):</label>
                <select id="pre_announcement_minutes_select">
                    <option value="1">1åˆ†å‰</option>
                    <option value="5">5åˆ†å‰</option>
                    <option value="10">10åˆ†å‰</option>
                    <option value="15">15åˆ†å‰</option>
                </select>

                <label for="pre_announcement_prefix_input">äºˆç´„å‰æ¡ˆå†…ã®æ¥é ­èª:</label>
                <input type="text" id="pre_announcement_prefix_input" value="ã¾ã‚‚ãªã">

                <label for="pre_announcement_suffix_input">äºˆç´„å‰æ¡ˆå†…ã®æ¥å°¾èª:</label>
                <input type="text" id="pre_announcement_suffix_input" value="é–‹å§‹">

                <label for="pre_announcement_default_text_input">äºˆç´„å‰æ¡ˆå†…ãŒãªã„å ´åˆã®è¡¨è¨˜:</label>
                <input type="text" id="pre_announcement_default_text_input" value="ã”æ¡ˆå†…">
            </div>

            <div class="setting-group">
                <h3>ç·Šæ€¥ä¼šè­°ã‚¤ãƒ™ãƒ³ãƒˆè¨­å®š</h3>
                <label for="event_summary_input">ã‚¤ãƒ™ãƒ³ãƒˆå (30åˆ†/60åˆ†å…±é€š):</label>
                <input type="text" id="event_summary_input" value="ç·Šæ€¥ä¼šè­°">
            </div>

            <hr style="display: none;"> </div>
    </div>

    <div id="container">
        <div id="event_list_container" class="panel">
            <h2 id="event_list_section_title">ç¾åœ¨ã®ä¼šè­°å®¤ã®äºˆå®š</h2>
            <ul id="event_list">
                <li>ã‚¤ãƒ™ãƒ³ãƒˆã‚’èª­ã¿è¾¼ã¿ä¸­...</li>
            </ul>
            <div class="action-button-group">
                <button id="add_30min_event_button" class="action-button">ç·Šæ€¥ä¼šè­° (30åˆ†)</button>
                <button id="add_60min_event_button" class="action-button">ç·Šæ€¥ä¼šè­° (60åˆ†)</button>
                <button id="refresh_button" class="action-button">æ›´æ–°</button>
            </div>
        </div>
    </div>
    <p id="error_display" class="error-message"></p>

    <script src="js/utils.js"></script>
    <script src="js/settings.js"></script>
    <script src="js/main.js"></script>
</body>
</html>
